# Ultra-simple Dockerfile with pre-built WAR
FROM tomcat:9.0-jdk11-openjdk

# Remove default apps
RUN rm -rf /usr/local/tomcat/webapps/*

# Copy pre-built WAR and extract
COPY target/ch14_ex1_email.war /tmp/app.war
RUN cd /usr/local/tomcat/webapps && \
    mkdir ROOT && \
    cd ROOT && \
    jar -xf /tmp/app.war && \
    rm /tmp/app.war

EXPOSE 8080
CMD ["catalina.sh", "run"]